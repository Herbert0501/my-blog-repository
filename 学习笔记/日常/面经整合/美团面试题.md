

## 一面1
### 1. 为什么是链表长度为8转红黑树？

在HashMap中，当链表长度达到8时，会转化为红黑树，原因如下：
- **性能考虑**：链表的查找时间复杂度为O(n)，而红黑树的查找时间复杂度为O(log n)。当链表长度较小时，链表的操作开销较低，但当链表长度过长时，查找和插入性能会明显下降。8被选为阈值，主要是因为对于小数据量（少于8个节点），链表操作的性能开销是可以接受的；而当链表节点数达到8时，使用红黑树能显著提升性能。
- **内存消耗**：红黑树相比链表需要额外的指针和颜色标记，占用更多的内存，因此HashMap只有在链表长度足够长（≥8）时，才会转化为红黑树，以达到性能与内存的平衡。

### 2. 节点个数为8的红黑树，减少一个元素会不会退化成链表，为什么？

不会立即退化成链表。  
当红黑树中的节点减少到一定数量时（默认是6），HashMap才会退化回链表。这样设计的原因是为了避免频繁地在链表和红黑树之间相互转换，因为频繁转换会带来额外的性能开销。因此，只有当红黑树中的节点数量减少到低于6时，才会退化为链表。

### 3. 红黑树是平衡树吗？删除一个节点，树的结构会怎么调整？

**红黑树是一种近似平衡的二叉搜索树**。虽然不如AVL树那样严格平衡，但红黑树的特性确保了它的最长路径不会超过最短路径的两倍，达到O(log n)的时间复杂度。

- **红黑树的性质**：
  1. 每个节点都是红色或黑色。
  2. 根节点是黑色的。
  3. 叶子节点（null节点）都是黑色的。
  4. 红色节点的子节点必须是黑色的（即不存在两个连续的红色节点）。
  5. 从任一节点到其叶子节点的所有路径包含相同数量的黑色节点。

**删除节点后的调整**：
- 删除一个节点后，可能会破坏红黑树的性质（例如红黑节点的平衡），因此需要通过旋转和重新着色来恢复平衡。
  - 若删除的节点是红色节点，红黑树的性质通常不会被破坏，不需要调整。
  - 若删除的节点是黑色节点，则可能会打破树的平衡，需要进行调整，包括“左旋”、“右旋”和“重新染色”等操作来恢复树的红黑特性。

### 4. 数组+链表的模式中，插入一个新节点，是头插还是尾插，为什么？

在HashMap中，链表的插入通常是**头插法**，即新节点插入在链表的头部。

原因如下：
- **效率**：头插法只需更改几个指针，时间复杂度为O(1)，而尾插法需要遍历链表到末尾，时间复杂度为O(n)，尤其当链表长度较长时，效率差距明显。
- **数据分布的特性**：在哈希冲突发生时，往往是近期插入的数据造成了冲突，因此头插法可以更快地访问最近插入的节点，提高查询效率。

### 5. HashMap扩容时，为什么长度要为2的幂次，扩容因子能否自己调整，为什么默认给0.75的扩容因子？

#### 1. 长度为2的幂次的原因：
- **高效计算**：HashMap的容量为2的幂次方，可以通过位运算（`n & (length - 1)`）快速确定元素存储的位置，这比取模运算（`%`）快得多。
- **分布均匀性**：使用位运算能够使得哈希值均匀地分布在数组各个位置上，从而减少哈希冲突。

#### 2. 扩容因子（负载因子）的调整：
- 扩容因子是HashMap何时扩容的决定因素，默认值为0.75，即当元素个数达到当前容量的75%时，HashMap会进行扩容。
- **可以自己调整**：负载因子是可以手动调整的。如果将负载因子设置得过低（例如0.5），HashMap会更频繁地扩容，导致插入性能下降，但查找速度会加快，因为哈希冲突更少；如果负载因子设置得过高（例如0.9），则可以减少扩容次数，但会增加冲突，查找效率下降。

#### 3. 为什么默认扩容因子为0.75？
- **性能与空间的平衡**：负载因子为0.75是查找性能与空间利用率的一个折衷点。若负载因子过小，空间利用率低，内存浪费大；若负载因子过大，哈希冲突增加，查找性能下降。经过大量测试，0.75被认为是一个比较合适的默认值。  
  
作者：Jezq  
链接：[https://www.nowcoder.com/users/history](https://www.nowcoder.com/users/history)  
来源：牛客网

## 一面2

怎么实现的定时任务？  
如果同时有很多任务同一时间待处理怎么办？  
  
Java你知道哪些锁（说了synchronized和reentrant）  
锁升级机制？（不知道）  
两者的优缺点？  
  
HashMap的实现？  
扩容机制？  
ConcurrentHashMap是怎么确保线程安全的？  
  
线程池是什么？  
线程池有哪些常用参数？（不知道）  
（面试官说建议多了解一下这个，我难蚌）  
  
mysql和redis用实际用过吗？  
mysql的索引有哪些？  
索引数据结构？  
有什么优点？  
知道回表吗？  
给了几个联合索引的例子，判断走不走索引（特别地：有联合索引ab和abc，查询的是ab则走哪个索引？为什么？）  
  
讲一下redis的AOF和RDB持久化  
redis有哪些缓存问题、如何解决？
举一个缓存的使用场景
热key问题怎么解决？
  
  
作者：Ryb1n  
链接：[https://www.nowcoder.com/?](https://www.nowcoder.com/?)  
来源：牛客网